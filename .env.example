# ============================================
# APEX.BUILD Environment Configuration
# ============================================
# Copy this file to .env and configure with your actual values
# WARNING: Never commit .env to version control!
#
# Required variables are marked with [REQUIRED]
# Optional variables have default values shown
# ============================================

# ============================================
# Application Settings
# ============================================

# Environment: development, staging, production
ENVIRONMENT=development

# Application version (set by CI/CD)
VERSION=dev

# ============================================
# Server Configuration
# ============================================

# Backend port
PORT=8080

# Gin framework mode: debug, release, test
GIN_MODE=debug

# Graceful shutdown timeout
GRACEFUL_SHUTDOWN_TIMEOUT=30s

# ============================================
# Database Configuration [REQUIRED]
# ============================================

# Full database URL (preferred, used by Render/Fly.io)
DATABASE_URL=postgres://postgres:apex_secret_2024@localhost:5432/apex_build?sslmode=disable

# Individual database settings (fallback if DATABASE_URL not set)
POSTGRES_DB=apex_build
POSTGRES_USER=postgres
POSTGRES_PASSWORD=apex_secret_2024
DB_HOST=localhost
DB_PORT=5432
DB_NAME=apex_build
DB_SSL_MODE=disable
DB_TIMEZONE=UTC

# Connection pool settings
DB_MAX_IDLE_CONNS=10
DB_MAX_OPEN_CONNS=100
DB_CONN_MAX_LIFETIME=1h

# ============================================
# Redis Configuration
# ============================================

REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=

# Redis connection pool
REDIS_POOL_SIZE=10
REDIS_MIN_IDLE_CONNS=5

# ============================================
# Authentication [REQUIRED for production]
# ============================================

# JWT secret key - CHANGE IN PRODUCTION!
# Generate with: openssl rand -base64 64
JWT_SECRET=super-secret-jwt-key-change-in-production

# JWT token expiration
JWT_EXPIRY=24h
JWT_REFRESH_EXPIRY=168h

# Session settings
SESSION_TIMEOUT=24h
BCRYPT_COST=12

# ============================================
# AI Provider API Keys [REQUIRED for AI features]
# ============================================

# Anthropic Claude API
# Get key at: https://console.anthropic.com/
ANTHROPIC_API_KEY=

# OpenAI API
# Get key at: https://platform.openai.com/api-keys
OPENAI_API_KEY=

# Google Gemini API
# Get key at: https://makersuite.google.com/app/apikey
GEMINI_API_KEY=

# Default AI model and settings
DEFAULT_AI_MODEL=claude-3-5-sonnet-20241022
MAX_TOKENS=4000
TEMPERATURE=0.7
TOP_P=0.95

# ============================================
# Secrets Manager
# ============================================

# Master key for encrypting project secrets
# Generate with: openssl rand -base64 32
SECRETS_MASTER_KEY=

# ============================================
# Payment Integration (Stripe)
# ============================================

# Stripe API keys
# Get keys at: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=
STRIPE_PUBLISHABLE_KEY=
STRIPE_WEBHOOK_SECRET=

# Price IDs from Stripe Dashboard
STRIPE_PRICE_PRO=
STRIPE_PRICE_TEAM=
STRIPE_PRICE_ENTERPRISE=

# ============================================
# Deployment Providers
# ============================================

# Vercel deployment
# Get token at: https://vercel.com/account/tokens
VERCEL_TOKEN=

# Netlify deployment
# Get token at: https://app.netlify.com/user/applications
NETLIFY_TOKEN=

# Render deployment
# Get key at: https://dashboard.render.com/u/settings/api-keys
RENDER_TOKEN=
RENDER_API_KEY=
RENDER_BACKEND_SERVICE_ID=
RENDER_FRONTEND_SERVICE_ID=

# ============================================
# OAuth Providers (optional)
# ============================================

# GitHub OAuth
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_CALLBACK_URL=http://localhost:8080/api/v1/auth/github/callback

# Google OAuth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_CALLBACK_URL=http://localhost:8080/api/v1/auth/google/callback

# ============================================
# CORS & Security
# ============================================

# Allowed origins for CORS (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:5180

# Allowed hosts
ALLOWED_HOSTS=localhost,127.0.0.1

# CSRF token length
CSRF_TOKEN_LENGTH=32

# ============================================
# File Storage
# ============================================

# Local file storage path
UPLOAD_PATH=./uploads
PROJECTS_DIR=/tmp/apex-build-projects

# Maximum upload size
MAX_FILE_SIZE=50MB

# Allowed file extensions
ALLOWED_EXTENSIONS=.js,.ts,.tsx,.jsx,.py,.go,.rs,.java,.cpp,.c,.html,.css,.json,.md,.txt,.yml,.yaml,.toml,.sh,.sql

# ============================================
# WebSocket Configuration
# ============================================

WS_MAX_CONNECTIONS=1000
WS_HEARTBEAT_INTERVAL=30s
WS_MESSAGE_BUFFER_SIZE=1024
WS_READ_BUFFER_SIZE=4096
WS_WRITE_BUFFER_SIZE=4096

# ============================================
# Code Execution Engine
# ============================================

EXECUTION_TIMEOUT=30s
EXECUTION_MEMORY_LIMIT=512MB
EXECUTION_CPU_LIMIT=1000m

# Supported languages (auto-detected)
# JavaScript, TypeScript, Python, Go, Rust, Java, C, C++, Ruby, PHP

# ============================================
# Rate Limiting
# ============================================

RATE_LIMIT_REQUESTS=1000
RATE_LIMIT_DURATION=1h
RATE_LIMIT_BURST=50

# API rate limits per tier
RATE_LIMIT_FREE=100
RATE_LIMIT_PRO=1000
RATE_LIMIT_TEAM=5000
RATE_LIMIT_ENTERPRISE=unlimited

# ============================================
# Logging & Monitoring
# ============================================

# Log level: debug, info, warn, error
LOG_LEVEL=debug

# Log format: text, json
LOG_FORMAT=text

# Enable Prometheus metrics endpoint
ENABLE_METRICS=true

# Enable distributed tracing (OpenTelemetry)
ENABLE_TRACING=false
OTEL_EXPORTER_OTLP_ENDPOINT=

# ============================================
# Error Tracking (Sentry)
# ============================================

# Get DSN at: https://sentry.io/
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================
# Frontend Configuration
# ============================================

# API endpoints for frontend build
VITE_API_URL=http://localhost:8080/api/v1
VITE_WS_URL=ws://localhost:8080/ws

# Feature flags
VITE_ENABLE_AI=true
VITE_ENABLE_COLLAB=true
VITE_ENABLE_DEPLOY=true

# ============================================
# Monitoring Stack (Docker Compose)
# ============================================

GRAFANA_USER=admin
GRAFANA_PASSWORD=admin

# ============================================
# Production URLs (set in CI/CD)
# ============================================

# PRODUCTION_API_URL=https://api.apex.build
# PRODUCTION_WS_URL=wss://api.apex.build/ws
# PRODUCTION_FRONTEND_URL=https://apex.build
